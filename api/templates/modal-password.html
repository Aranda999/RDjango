<div class="modal fade" id="cambiarContrasenaModal" tabindex="-1" aria-labelledby="cambiarContrasenaModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" style="max-width: 400px; margin: 0 auto;">
        <div class="modal-content" style="border-radius: 5px;">
            <div class="modal-header" style="background-color: rgb(65, 70, 71); border-radius: 3px 3px 0 0; padding: 10px;">
                <h5 class="modal-title" id="cambiarContrasenaModalLabel" style="color: #fff; font-weight: bold;">Cambio de Contraseña</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body" style="padding: 20px;">
                <!-- Mostrar los mensajes de error dentro del modal -->
                {% if messages %}
                    <div class="alert alert-danger" style="height: 60px; position: relative; top: 10px;">
                        {% for message in messages %}
                            <p style="font-size: 14px; text-align: center;">{{ message }}</p>
                        {% endfor %}
                    </div>
                {% endif %}
                
                <form method="POST">
                    {% csrf_token %}
                    <div class="mb-3">
                        <label for="nuevaContrasena" class="form-label" style="color: black;">Nueva contraseña</label>
                        <div class="input-group input-group-sm">
                            <input type="password" class="form-control" id="nuevaContrasena" placeholder="***********" name="nuevaContrasena" required style="border: 1px solid black; height: 35px; color: black; width: 100%;">
                        </div>
                    </div>
                    <div class="mb-3">
                        <label for="confirmarContrasena" class="form-label" style="color: black;">Confirmar contraseña</label>
                        <div class="input-group input-group-sm">
                            <input type="password" class="form-control" id="confirmarContrasena" placeholder="***********" name="confirmarContrasena" required style="border: 1px solid black; height: 35px; color: black; width: 100%;">
                        </div>
                    </div>
                    <button type="submit" class="btn" style="background-color: #ff6200; color: black; width: 50%; margin: 0 auto; display: block; padding: 5px; border: 1px solid black; border-radius: 5px; font-weight: bold;">Guardar</button>
                </form>
            </div>
        </div>
    </div>
</div>

<script>
    // Evento para limpiar los campos cuando el modal se cierra
    var myModal = document.getElementById('cambiarContrasenaModal')
    myModal.addEventListener('hidden.bs.modal', function () {
        // Limpiar los campos del formulario
        document.getElementById('nuevaContrasena').value = '';
        document.getElementById('confirmarContrasena').value = '';
        
        // Limpiar los mensajes de error dentro del modal
        var alertContainer = document.querySelector('.alert-danger');
        if (alertContainer) {
            alertContainer.remove();  // Eliminar el mensaje de error
        }
    });

    // Agregar un evento al formulario para mostrar un mensaje de error en caso de que las contraseñas no coincidan
    document.querySelector('form').addEventListener('submit', function(event) {
        // Obtener las contraseñas
        var nuevaContrasena = document.getElementById('nuevaContrasena').value;
        var confirmarContrasena = document.getElementById('confirmarContrasena').value;

        // Verificar si las contraseñas coinciden
        if (nuevaContrasena !== confirmarContrasena) {
            event.preventDefault(); // Evitar que el formulario se envíe
            var errorMessage = "Las contraseñas no coinciden. Por favor, inténtalo de nuevo.";  // Mensaje de error

            // Crear el contenedor de error si no existe
            var alertContainer = document.querySelector('.alert-danger');
            if (!alertContainer) {
                alertContainer = document.createElement('div');
                alertContainer.classList.add('alert', 'alert-danger');
                alertContainer.style.height = '60px';
                alertContainer.style.position = 'relative';
                alertContainer.style.top = '10px';
                alertContainer.style.fontSize = '14px';
                alertContainer.style.textAlign = 'center';
                document.querySelector('.modal-body').insertBefore(alertContainer, document.querySelector('form'));
            }

            alertContainer.textContent = errorMessage;  // Establecer el mensaje de error
        }
    });
</script>
